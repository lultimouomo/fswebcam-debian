# Descritpion: Don't draw a banner if drawing text doesn't work.
# Author: Luca Niccoli <lultimouomo@gmail.com>
# Forwarded: By mail

--- a/fswebcam.c	2009-12-21 00:09:59.000000000 +0100
+++ b/fswebcam.c	2010-01-13 22:07:44.142600767 +0100
@@ -962,6 +962,10 @@
 	/* Draw the underlay. */
 	fswc_draw_overlay(config, config->underlay, im);
 	
+	/* Check if drawing text works */
+	if (gdImageStringFT(NULL, NULL, config->fg_colour, config->font, config->fontsize, 0.0, 0, 0, ""))
+		config->banner = NO_BANNER;
+        
 	/* Draw the banner. */
 	if(config->banner != NO_BANNER) fswc_draw_banner(config, im);
 	
